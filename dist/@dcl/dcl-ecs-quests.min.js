"use strict";var __decorate=this&&this.__decorate||function(e,r,o,i){var s,l=arguments.length,f=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(e,r,o,i);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(f=(l<3?s(f):l>3?s(r,o,f):s(r,o))||f);return l>3&&f&&Object.defineProperty(r,o,f),f},__values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&e[r],i=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(e){try{step(i.next(e))}catch(e){l(e)}}function rejected(e){try{step(i.throw(e))}catch(e){l(e)}}function step(e){var r;e.done?s(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(fulfilled,rejected)}step((i=i.apply(e,r||[])).next())}))},__generator=this&&this.__generator||function(e,r){var o,i,s,l,f={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(l){return function(d){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;f;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return f.label++,{value:l[1],done:!1};case 5:f.label++,i=l[1],l=[0];continue;case 7:l=f.ops.pop(),f.trys.pop();continue;default:if(!((s=(s=f.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){f=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){f.label=l[1];break}if(6===l[0]&&f.label<s[1]){f.label=s[1],s=l;break}if(s&&f.label<s[2]){f.label=s[2],f.ops.push(l);break}s[2]&&f.ops.pop(),f.trys.pop();continue}l=r.call(e,f)}catch(e){l=[6,e],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}},__createBinding=this&&this.__createBinding||(Object.create?function(e,r,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[o]}})}:function(e,r,o,i){void 0===i&&(i=o),e[i]=r[o]}),__exportStar=this&&this.__exportStar||function(e,r){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||__createBinding(r,e,o)},__read=this&&this.__read||function(e,r){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var i,s,l=o.call(e),f=[];try{for(;(void 0===r||r-- >0)&&!(i=l.next()).done;)f.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}return f},__spreadArray=this&&this.__spreadArray||function(e,r){for(var o=0,i=r.length,s=e.length;o<i;o++,s++)e[s]=r[o];return e};define("dcl-quests-client/quests-client-amd",(function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){var r={exports:{}};return e(r,r.exports),r.exports}var r=n((function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fromBase64=r.toBase64=void 0;var o="function"==typeof btoa?btoa:function(e){return Buffer.from(e).toString("base64")},i="function"==typeof atob?atob:function(e){return Buffer.from(e,"base64").toString("utf-8")};r.toBase64=function(e){return o(e)},r.fromBase64=function(e){return i(e)}})),o=n((function(e,o){function n(e){return e.split("").reverse().join("")}Object.defineProperty(o,"__esModule",{value:!0}),o.DefObf=void 0,o.DefObf=new(function(){function t(){}return t.prototype.obf=function(e){return n(r.toBase64(e)).replace(/=/g,"_")},t.prototype.deobf=function(e){return r.fromBase64(n(e.replace(/_/g,"=")))},t}())})),i=n((function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AUTH_METADATA_HEADER=r.AUTH_TIMESTAMP_HEADER=r.AUTH_CHAIN_HEADER_PREFIX=void 0,r.AUTH_CHAIN_HEADER_PREFIX="x-identity-auth-chain-",r.AUTH_TIMESTAMP_HEADER="x-identity-timestamp",r.AUTH_METADATA_HEADER="x-identity-metadata"})),s=n((function(e,r){var o,i,s;Object.defineProperty(r,"__esModule",{value:!0}),r.GivenRewardStatus=r.Visibility=r.ProgressStatus=void 0,(o=r.ProgressStatus||(r.ProgressStatus={})).BLOCKED="blocked",o.NOT_STARTED="not_started",o.ON_GOING="on_going",o.COMPLETED="completed",o.FAILED="failed",o.REVERTED="reverted",(i=r.Visibility||(r.Visibility={})).VISIBLE="visible",i.VISIBLE_IF_CAN_START="visible_if_can_start",i.SECRET="secret",(s=r.GivenRewardStatus||(r.GivenRewardStatus={})).OK="ok",s.ALREADY_GIVEN="already_given",s.TASK_ALREADY_COMPLETED="task_already_completed",s.FAILED="failed"})),l=n((function(r,l){var f=e&&e.__createBinding||(Object.create?function(e,r,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[o]}})}:function(e,r,o,i){void 0===i&&(i=o),e[i]=r[o]}),d=e&&e.__exportStar||function(e,r){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||f(r,e,o)};Object.defineProperty(l,"__esModule",{value:!0}),d(o,l),d(i,l),d(s,l)})),f=n((function(r,o){var i=e&&e.__awaiter||function(e,r,o,i){return new(o||(o=Promise))((function(s,l){function u(e){try{c(i.next(e))}catch(e){l(e)}}function a(e){try{c(i.throw(e))}catch(e){l(e)}}function c(e){var r;e.done?s(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(u,a)}c((i=i.apply(e,r||[])).next())}))},s=e&&e.__generator||function(e,r){var o,i,s,l,f={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(d){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;f;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return f.label++,{value:l[1],done:!1};case 5:f.label++,i=l[1],l=[0];continue;case 7:l=f.ops.pop(),f.trys.pop();continue;default:if(!((s=(s=f.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){f=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){f.label=l[1];break}if(6===l[0]&&f.label<s[1]){f.label=s[1],s=l;break}if(s&&f.label<s[2]){f.label=s[2],f.ops.push(l);break}s[2]&&f.ops.pop(),f.trys.pop();continue}l=r.call(e,f)}catch(e){l=[6,e],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.flatFetch=void 0,o.flatFetch=function(e,r){return i(this,void 0,void 0,(function(){var o,i,l,f,d,p;return s(this,(function(s){switch(s.label){case 0:return[4,fetch(e,r)];case 1:switch(o=s.sent(),i=(null==r?void 0:r.responseBodyType)||"text",l={},o.headers.forEach((function(e,r){return l[r]=e})),f={ok:o.ok,status:o.status,statusText:o.statusText,headers:l},i){case"json":return[3,2];case"text":return[3,4]}return[3,6];case 2:return d=f,[4,o.json()];case 3:return d.json=s.sent(),[3,6];case 4:return p=f,[4,o.text()];case 5:return p.text=s.sent(),[3,6];case 6:return[2,f]}}))}))}})),d=n((function(r,o){var i=e&&e.__assign||function(){return(i=Object.assign||function(e){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)},s=e&&e.__awaiter||function(e,r,o,i){return new(o||(o=Promise))((function(s,l){function u(e){try{c(i.next(e))}catch(e){l(e)}}function a(e){try{c(i.throw(e))}catch(e){l(e)}}function c(e){var r;e.done?s(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(u,a)}c((i=i.apply(e,r||[])).next())}))},d=e&&e.__generator||function(e,r){var o,i,s,l,f={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(d){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;f;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return f.label++,{value:l[1],done:!1};case 5:f.label++,i=l[1],l=[0];continue;case 7:l=f.ops.pop(),f.trys.pop();continue;default:if(!((s=(s=f.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){f=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){f.label=l[1];break}if(6===l[0]&&f.label<s[1]){f.label=s[1],s=l;break}if(s&&f.label<s[2]){f.label=s[2],f.ops.push(l);break}s[2]&&f.ops.pop(),f.trys.pop();continue}l=r.call(e,f)}catch(e){l=[6,e],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}};function u(e,r,o,i){var s={},f=Date.now(),d=JSON.stringify(o);return i([e.toLowerCase(),r.toLowerCase(),f.toString(),d].join(":").toLowerCase()).forEach((function(e,r){s[""+l.AUTH_CHAIN_HEADER_PREFIX+r]=JSON.stringify(e)})),s[l.AUTH_TIMESTAMP_HEADER]=f.toString(),s[l.AUTH_METADATA_HEADER]=d,s}Object.defineProperty(o,"__esModule",{value:!0}),o.authFetch=void 0,o.authFetch=function(e){return function(r,o){var l,p;return s(this,void 0,void 0,(function(){var s,h;return d(this,(function(d){return s=new URL(r).pathname,h=i(i({},o),{headers:i(i({},u(null!==(l=null==o?void 0:o.method)&&void 0!==l?l:"get",s,null!==(p=null==o?void 0:o.metadata)&&void 0!==p?p:{},e)),null==o?void 0:o.headers)}),[2,f.flatFetch(r,h)]}))}))}}})),p=n((function(r,o){var i=e&&e.__assign||function(){return(i=Object.assign||function(e){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)},s=e&&e.__awaiter||function(e,r,o,i){return new(o||(o=Promise))((function(s,l){function u(e){try{c(i.next(e))}catch(e){l(e)}}function a(e){try{c(i.throw(e))}catch(e){l(e)}}function c(e){var r;e.done?s(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(u,a)}c((i=i.apply(e,r||[])).next())}))},p=e&&e.__generator||function(e,r){var o,i,s,l,f={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(d){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;f;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return f.label++,{value:l[1],done:!1};case 5:f.label++,i=l[1],l=[0];continue;case 7:l=f.ops.pop(),f.trys.pop();continue;default:if(!((s=(s=f.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){f=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){f.label=l[1];break}if(6===l[0]&&f.label<s[1]){f.label=s[1],s=l;break}if(s&&f.label<s[2]){f.label=s[2],f.ops.push(l);break}s[2]&&f.ops.pop(),f.trys.pop();continue}l=r.call(e,f)}catch(e){l=[6,e],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.QuestsClient=void 0;var h=function(){function t(e){var r;this.options=e,this.obf=l.DefObf,e.authChainProvider?this.fetchFn=d.authFetch(e.authChainProvider):this.fetchFn=null!==(r=e.fetchFn)&&void 0!==r?r:f.flatFetch}return t.prototype.urlFor=function(e){return""+this.options.baseUrl+e},t.prototype.fetch=function(e,r){return s(this,void 0,void 0,(function(){var o,l=this;return p(this,(function(f){return(null==r?void 0:r.bodyObject)&&(r.body=JSON.stringify(r.bodyObject),r.obf?(r.body=this.obf.obf(r.body),r.headers=i(i({},r.headers),{"Content-Type":"application/quests"})):r.headers=i(i({},r.headers),{"Content-Type":"application/json"})),o=i(i({},r),{metadata:this.options.metadata,responseBodyType:"text"}),[2,this.fetchFn(this.urlFor(e),o).then((function(e){return s(l,void 0,void 0,(function(){var o,i;return p(this,(function(s){return o=e.text||"",(null==r?void 0:r.deobf)&&e.ok&&(o=this.obf.deobf(o)),i=function(e){try{return JSON.parse(e)}catch(r){return e}}(o),[2,{ok:e.ok,status:e.status,body:i}]}))}))}))]}))}))},t.prototype.getQuests=function(){return s(this,void 0,void 0,(function(){return p(this,(function(e){return[2,this.fetch("/quests")]}))}))},t.prototype.getQuestDetails=function(e){return s(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.fetch("/quests/"+e)]}))}))},t.prototype.startQuest=function(e){return s(this,void 0,void 0,(function(){return p(this,(function(r){return[2,this.fetch("/s/"+this.obf.obf(e),{method:"post",deobf:!0})]}))}))},t.prototype.updateArbitraryState=function(e,r){return s(this,void 0,void 0,(function(){return p(this,(function(o){return[2,this.fetch("/kv/"+this.obf.obf(e),{method:"put",deobf:!0,obf:!0,bodyObject:r})]}))}))},t.prototype.makeProgress=function(e,r,o){return s(this,void 0,void 0,(function(){return p(this,(function(i){return[2,this.fetch("/p/"+this.obf.obf(e)+"/"+this.obf.obf(r),{method:"post",deobf:!0,obf:!0,bodyObject:o})]}))}))},t}();o.QuestsClient=h}));return function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(n((function(r,o){var i=e&&e.__createBinding||(Object.create?function(e,r,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[o]}})}:function(e,r,o,i){void 0===i&&(i=o),e[i]=r[o]}),l=e&&e.__exportStar||function(e,r){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||i(r,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),l(p,o),l(s,o)})))})),define("@dcl/types",["require","exports"],(function(e,r){Object.defineProperty(r,"__esModule",{value:!0})})),define("@dcl/component",["require","exports"],(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.QuestTrackingInfo=void 0;var o=function(){function QuestTrackingInfo(e){this.questData=e}return QuestTrackingInfo.prototype.toJSON=function(){return this.questData},__decorate([Component("engine.questTrackingComponent",1417815519)],QuestTrackingInfo)}();r.QuestTrackingInfo=o})),define("@dcl/mappings",["require","exports"],(function(e,r){function toRendererSections(e){var r=e.reduce((function(e,r){var o,i,s=null!==(o=r.section)&&void 0!==o?o:"",l=null!==(i=e[s])&&void 0!==i?i:{id:s,name:s,progress:0,tasks:[]};return l.tasks.push(function(e){return{id:e.id,progress:e.progressPercentage,name:e.description,coordinates:e.coordinates,payload:JSON.stringify(getProgressPayload(e)),status:e.progressStatus,type:e.progressMode.type}}(r)),e[s]=l,e}),{}),o=[];for(var i in r){var s=r[i];s.progress=s.tasks.length>0?s.tasks.reduce((function(e,r){return e+r.progress}),0)/s.tasks.length:0,o.push(s)}return o}function getProgressPayload(e){switch(e.progressMode.type){case"single":return{isDone:"completed"===e.progressStatus};default:return{type:"numeric",start:e.progressSummary.start,end:e.progressSummary.end,current:e.progressSummary.current}}}function gatherRewards(e){var r,o,i,s,l,f,d,p,h,y,v,_,b,g,m,w,S,T,k=[],_loop_1=function(r){k.push({id:null!==(d=r.id)&&void 0!==d?d:"",name:null!==(p=r.name)&&void 0!==p?p:"",type:null!==(h=r.type)&&void 0!==h?h:"",imageUrl:null!==(y=r.imageUrl)&&void 0!==y?y:"",status:null!==(_=null===(v=e.givenRewards.filter((function(e){return e.reward.id===r.id}))[0])||void 0===v?void 0:v.status)&&void 0!==_?_:"not_given"})};try{for(var E=__values(e.rewards),O=E.next();!O.done;O=E.next())_loop_1(O.value)}catch(e){r={error:e}}finally{try{O&&!O.done&&(o=E.return)&&o.call(E)}finally{if(r)throw r.error}}try{for(var P=__values(e.tasks),x=P.next();!x.done;x=P.next()){var R=x.value,_loop_2=function(e){k.push({id:null!==(b=e.id)&&void 0!==b?b:"",name:null!==(g=e.name)&&void 0!==g?g:"",type:null!==(m=e.type)&&void 0!==m?m:"",imageUrl:null!==(w=e.imageUrl)&&void 0!==w?w:"",status:null!==(T=null===(S=R.givenRewards.filter((function(r){return r.reward.id===e.id}))[0])||void 0===S?void 0:S.status)&&void 0!==T?T:"not_given"})};try{for(var A=(l=void 0,__values(R.rewards)),j=A.next();!j.done;j=A.next())_loop_2(j.value)}catch(e){l={error:e}}finally{try{j&&!j.done&&(f=A.return)&&f.call(A)}finally{if(l)throw l.error}}}}catch(e){i={error:e}}finally{try{x&&!x.done&&(s=P.return)&&s.call(P)}finally{if(i)throw i.error}}return k}Object.defineProperty(r,"__esModule",{value:!0}),r.toRendererQuest=void 0,r.toRendererQuest=function(e){return{id:e.id,name:e.name,description:e.description,icon:e.icon,thumbnail_banner:e.thumbnailBanner,thumbnail_entry:e.thumbnailEntry,status:e.progressStatus,sections:toRendererSections(e.tasks),rewards:gatherRewards(e),visibility:e.visibility}}})),define("@dcl/RemoteQuestTracker",["require","exports","dcl-quests-client/quests-client-amd","@decentraland/SignedFetch","@dcl/component","@dcl/mappings","@decentraland/EnvironmentAPI"],(function(e,r,o,i,s,l,f){Object.defineProperty(r,"__esModule",{value:!0}),r.RemoteQuestTracker=void 0;var d={baseUrl:"https://quests-api.decentraland.io",clientFactory:function(e){return new o.QuestsClient({baseUrl:e,fetchFn:i.signedFetch})},logErrors:!0,addToEngine:!0},p=function(){function RemoteQuestTracker(e,r){var o=this;this.questId=e,this.options=__assign(__assign({},d),null!=r?r:{}),this.client=this.options.clientFactory(this.options.baseUrl),f.getExplorerConfiguration&&f.getExplorerConfiguration().then((function(e){"string"==typeof e.configurations.questsServerUrl&&(o.options.baseUrl=e.configurations.questsServerUrl,o.client=o.options.clientFactory(o.options.baseUrl))})),this.entity=new Entity,this.options.addToEngine&&engine.addEntity(this.entity),this.refresh()}return RemoteQuestTracker.prototype.refresh=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(r){return[2,this.updateQuest(this.makeRequest((function(){return e.client.getQuestDetails(e.questId)})))]}))}))},RemoteQuestTracker.prototype.startQuest=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(r){return[2,this.updateQuest(this.makeRequest((function(){return e.client.startQuest(e.questId)})))]}))}))},RemoteQuestTracker.prototype.makeProgress=function(e,r){return __awaiter(this,void 0,void 0,(function(){var o=this;return __generator(this,(function(i){return[2,this.updateQuest(this.makeRequest((function(){return o.client.makeProgress(o.questId,e,r)})))]}))}))},RemoteQuestTracker.prototype.updateArbitraryState=function(e){return __awaiter(this,void 0,void 0,(function(){var r=this;return __generator(this,(function(o){return[2,this.updateQuest(this.makeRequest((function(){return r.client.updateArbitraryState(r.questId,e)})))]}))}))},RemoteQuestTracker.prototype.getCurrentStatePromise=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return this.currentStatePromise?[2,this.currentStatePromise]:[2]}))}))},RemoteQuestTracker.prototype.getCurrentState=function(){return this.currentState},RemoteQuestTracker.prototype.makeRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:return[4,e()];case 1:return(r=o.sent()).ok||this.options.logErrors&&log("Error performing request on quest with id: "+this.questId+". Status: "+r.status,{body:r.body}),[2,r]}}))}))},RemoteQuestTracker.prototype.updateQuest=function(e){return __awaiter(this,void 0,void 0,(function(){var r,o;return __generator(this,(function(i){switch(i.label){case 0:return this.currentStatePromise=e.then((function(e){if(e.ok)return e.body;throw new Error("Could not get quest state. Status: "+e.status+". Body: "+e.body)})),[4,e];case 1:return(r=i.sent()).ok&&(this.currentState=r.body,(o=this.entity.getComponentOrNull(s.QuestTrackingInfo))?o.questData=l.toRendererQuest(this.currentState):this.entity.addComponent(new s.QuestTrackingInfo(l.toRendererQuest(this.currentState)))),[2,r]}}))}))},RemoteQuestTracker}();r.RemoteQuestTracker=p})),define("@dcl/ecs-quests",["require","exports","@dcl/component","@dcl/mappings","@dcl/types","@dcl/RemoteQuestTracker"],(function(e,r,o,i,s,l){Object.defineProperty(r,"__esModule",{value:!0}),__exportStar(o,r),__exportStar(i,r),__exportStar(s,r),__exportStar(l,r)})),define("@dcl/quests-query",["require","exports","dcl-quests-client/quests-client-amd"],(function(e,r,o){function find(e,r){var o,i;try{for(var s=__values(e),l=s.next();!l.done;l=s.next()){var f=l.value;if(r(f))return f}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}function flatMap(e,r){return e.map(r).reduce((function(e,r){return e.concat(r)}),[])}Object.defineProperty(r,"__esModule",{value:!0}),r.query=void 0,r.query=function(e){return new(function(){function class_1(){}return class_1.prototype.getTaskStatus=function(r){var o;return null===(o=find(e.tasks,(function(e){return e.id===r})))||void 0===o?void 0:o.progressStatus},class_1.prototype.getStepStatus=function(r){var o;return null===(o=find(flatMap(e.tasks,(function(e){return e.steps})),(function(e){return e.id===r})))||void 0===o?void 0:o.progressStatus},class_1.prototype.isTaskCompleted=function(e){return this.getTaskStatus(e)===o.ProgressStatus.COMPLETED},class_1.prototype.isStepCompleted=function(e){return this.getStepStatus(e)===o.ProgressStatus.COMPLETED},class_1.prototype.getTaskProgress=function(r){var o;return null===(o=find(e.tasks,(function(e){return e.id===r})))||void 0===o?void 0:o.progressSummary},class_1.prototype.getAllGivenRewards=function(){return __spreadArray(__spreadArray([],__read(e.givenRewards)),__read(flatMap(e.tasks,(function(e){return e.givenRewards}))))},class_1}())}}));